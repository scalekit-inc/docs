---
description: Verify SSO Connection using IdP Simulator
title: Test SSO
displayed_sidebar: homeSidebar
toc_min_heading_level: 2
---

# Test SSO

<Subtitle>
  Verify SSO Connection
</Subtitle>

Using our [Quickstart guide](@docs/sso/quickstart), you would have integrated Scalekit and implemented the SSO authentication in your sandbox environment. Now, it's time to test your SSO integration for all possible customer scenarios.

Scalekit simplifies SSO testing for developers by providing two key components:

- A *Test Organisation* that you can use to test singing into your app as a user with email domains <SimpleCode>@example.com</SimpleCode> or <SimpleCode>@example.org</SimpleCode>. For example, user\@example.org
- An *IdP Simulator* that implements OpenID Connect (OIDC) protocol and sends your app the profile details.

Use these components to test for the following scenarios.

## Scenario 1: Service Provider (SP) Initiated SSO

In the most common scenario, users access your application, which then initiates Single Sign-On (SSO).

Here's a recap:

<figure>
  ![SP initiated SSO](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/1.png)
  <figcaption>
    User initiates SSO from your app
  </figcaption>
</figure>

To validate this scenario, ensure the following::

- **Redirection to Identity Provider**: Verify that Scalekit correctly redirects the user to the appropriate identity provider based on the [Authorization URL](https://docs.scalekit.com/sso/guides/key-concepts/authorization-url) you have provided. This involves checking that the URL is constructed correctly and that the redirection occurs seamlessly.
- **Retrieving User Details**: Confirm that your application can successfully retrieve user details by exchanging the <SimpleCode>code</SimpleCode> received in the previous step.

To test this scenario, generate authorization URL using the organization ID of the Test Organization.

<figure>
  ![SP initiated SSO](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/1.1.png)
  <figcaption>
    The Test Organization is located at Workspace → Development → Organizations → Test Organization.
  </figcaption>
</figure>

Here is a code snippet that demonstrates generating an Authorization URL using an Organization ID, as outlined in Step 2 of the sequence diagram. See the Authorization URL [documentation](/sso/guides/key-concepts/authorization-url) for more details.

<Tabs groupId="tech-stack" queryString>
<TabItem value="nodejs" label="Node.js">

```js
const options = {};
options["organizationId"] = 'org_32656XXXXXX0438';

// Generate Authorization Url
const authorizationURL = scalekit.getAuthorizationUrl(
  redirectUrl,
  options,
);

res.redirect(authorizationUrl);
```
</TabItem>

<TabItem value="python" label="Python">

```py
options = {"organizationId": 'org_32656XXXXXX0438'}

# Generate Authorization URL
authorization_url = scalekit.get_authorization_url(
    redirect_url,
    options,
)

redirect(authorization_url)
```
</TabItem>

<TabItem value="go" label="Go">

```go
options.organizationId = "org_32656XXXXXX0438"

// Generate Authorization URL
authorizationURL := scalekitClient.GetAuthorizationUrl(
  redirectUrl,
  options,
)

// Redirect the user to the Authorization URL
```
</TabItem>
<TabItem value="java" label="Java">

```java
options.setOrganizationId("org_32656XXXXXX0438");

// Generate Authorization Url
String url = scalekitClient
        .authentication()
        .getAuthorizationUrl(redirectUrl, options)
        .toString();

// Redirect the user to the Authorization URL
```
</TabItem>
</Tabs>

The user will be redirected to the Identity Provider (IdP) Simulator, where they can select a scenario to simulate as a user. Select "User Login via SSO" to view a form. This form is used to simulate the Identity Provider (IdP) passing the relevant details that correspond to a user signing into your application.

<figure>
  ![IdP Simulator](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/2.1.png)
  <figcaption>
    User Login via SSO
  </figcaption>
</figure>

Enter the user details simulating an user signing into your application via SSO. Your app will receive the <SimpleCode>idToken</SimpleCode> indicating that your simulation was successful. The following are a details encoded in the <SimpleCode>idToken</SimpleCode>.

<figure>
  ![IdP Simulator](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/2.2.png)
  <figcaption>
    Successful SSO Simulation (Test app renders response in JSON)
  </figcaption>
</figure>

:::tip
 To receive Custom Attributes from the IdP Simulator, ensure they are registered in Scalekit Workspace by navigating to Development > Single Sign-On > Custom Attributes.
 :::

## Scenario 2: User initiates SSO from IdP

Users can also initiate the sign-in process to your application from the Identity Provider (IdP), typically through an applications catalog. This flow enables them to see the applications available to them within their organization and access them conveniently. Here is a sequence outlining how IdP-initiated Single Sign-On (SSO) works:

<figure>
  ![IdP initiated SSO](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/4.png)
  <figcaption>
    User initiates SSO from IdP
  </figcaption>
</figure>

To test this scenario, generate the Authorization URL using the Test Organization and get redirected to the IdP Simulator. Select "IdP initiated SSO" from the dropdown menu and proceed to simulate the login by entering the test user details.

<figure>
  ![IdP initiated SSO](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/3.1.png)
  <figcaption>
    IdP initiated SSO
  </figcaption>
</figure>

Implement a condition in your callback handler to identify whether the callback from Scalekit is IdP-initiated or not to handle this scenario. Learn more about [implementing IdP initiated SSO](sso/guides/setup-sso/implement-idp-initiated-sso).

<figure>
  ![IdP initiated SSO](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/3.2.png)
  <figcaption>
    Successful IdP initiated SSO Simulation (Test app renders response in JSON)
  </figcaption>
</figure>

If the callback is IdP-initiated, retrieve the necessary details, such as <SimpleCode>connection_id</SimpleCode> or <SimpleCode>organization_id</SimpleCode>, from Scalekit to construct an Authorization URL. This step effectively converts an IdP-initiated SSO into an SP-initiated SSO.

:::note
- For simulation purposes in the IdP simulator, you can select and simulate IdP-initiated SSO to test your application. In an ideal scenario, users would choose your app from their Identity Provider and begin the sign-in process into your app.
- The IdP simulator uses the default redirect URL as the callback URL when a user initiates SSO from the IdP. Ensure the correct default redirect URL is configured in the Scalekit dashboard.
:::

## Scenario 3: Handle Errors

Users may encounter errors in less-than-ideal scenarios. Your app should be equipped to handle these situations to meet user expectations. To simulate and manage errors, after redirecting to the Authorization URL, select the "Error" scenario and proceed

<figure>
  ![Error Scenario](@site/docs/sso/assets/single-sign-on/testing-sso/with-idp-simulator/4.0.png)
    <figcaption>
     Simulate Error Scenario
    </figcaption>
</figure>

## Next Steps
After validating all scenarios, you are ready to go live. Visit our [Launch Checklist](/sso/launch-checklist) guide before you start onboarding real customers in your production environment.