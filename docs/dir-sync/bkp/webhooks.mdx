# Webhooks

Webhooks are powerful tools that allow your application to receive real-time notifications about specific occurrences within the ScaleKit system. Events represent specific actions or changes, while webhooks are the mechanism used to deliver these event notifications to your specified endpoint.

By leveraging webhooks, you can build responsive and dynamic integrations that react immediately to changes in your directory sync data, enabling you to keep your systems in sync and automate user provisioning and deprovisioning.

## Webhook Security

While webhooks are a powerful tool for receiving real-time updates, it's important to ensure that you always verify if the incoming webhooks is indeed coming from Scalekit and not from a malicious actor.

There are typically two types of webhook security mechanisms that you can use to ensure the authenticity and integrity of the incoming webhook.

### Webhook Signature verification

Every incoming webhook is signed with a secret key. This secret key is available in the Scalekit Dashboard under the "Webhooks" section.

 {/* ![Webhook Signature Verification](/img/webhook-signature-verification.png) */}

A cryptographic hash is generated for the payload containing webhook id, webhook body and the timestamp with the webhook secret as a key using the HMAC-SHA256 algorithm. This signature is then sent as part of the `svix-signature` header. You can use the following code to locally compute the signature and verify the webhook signature if it matches with the one sent by Scalekit:

<CodeWithHeader title="Webhook Signature Verification">
<Tabs>

<TabItem label="Node.js" value="Node.js">

```javascript
// Work in progress
```

</TabItem>


<TabItem label="Python" value="Python">

```python
import hmac
import hashlib

def verify_webhook_signature(webhook_body, signature, secret_key):
    computed_signature = hmac.new(secret_key.encode(), webhook_body, hashlib.sha256).hexdigest()
    return computed_signature == signature
```

</TabItem>

</Tabs>
</CodeWithHeader>
### Webhook Timestamp verification

Even though the webhook signature verification is enough to ensure that the incoming webhook is indeed coming from Scalekit and not from a malicious actor, we also recommend that you verify the webhook timestamp to ensure that the webhook is not stale or just replayed after sometime.

To mitigate the risk of replay attacks, we recommend that you verify the webhook timestamp and ensure that the webhook is within a tolerance window of 60 seconds. Our SDKs and libraries provide helper functions to verify the webhook timestamp automatically as part of the webhook signature verification process.

{/* ## Directory Sync Webhooks

Below are the list of Directory Sync webhooks that you can use to listen for changes in the directory and update the user's roles in your application.

| Event Type | Use Case | Description |
|----------|----------|----------|
| <SimpleCode>scalekit.dir.user.create</SimpleCode>         | Automated User Provisioning         | Triggered when a new user is added to the directory. <br /><br />Detailed Webhook payload can be found [here](/apis#tag/Webhooks/scalekit.dir.user.create)        |
| <SimpleCode>scalekit.dir.user.update</SimpleCode>         | Automated User Profile Updates         | Triggered when a user's information is modified in the directory. <br /><br />Detailed Webhook payload can be found [here](/apis#tag/Webhooks/scalekit.dir.user.update)        |
| <SimpleCode>scalekit.dir.user.delete</SimpleCode>         | Automated User Deprovisioning         | Triggered when a user is removed from the directory. <br/><br />Also triggered when a user's status is marked as `inactive` in the directory or if the user is removed from all groups assigned to this application. <br /><br />Detailed Webhook payload can be found [here](/apis#tag/Webhooks/scalekit.dir.user.delete)        |
| <SimpleCode>scalekit.dir.user.update</SimpleCode>         | Automated User Role Assignment         | To implement automated role assignment, you must enable the ["Group Based Access Control"](/dir-sync/gbac) setting in the Scalekit Dashboard and configure all the available roles in your application. <br /><br />As part of your customer's Directory Sync configuration, your customers would configure the mapping between the Groups in their Directory Provider and the Roles in your application. <br /><br />Scalekit will automatically listen to the changes of user and group assignment in your customer's Directory Provider and based on your customer's configuration, we will update the `roles` attribute of the user. <br /><br />Detailed Webhook payload can be found [here](/apis#tag/Webhooks/scalekit.dir.user.update)        |

For a detailed list of all the available webhooks and the corresponding webhook payloads, refer to our API Documentation [here](/apis#tag/Webhooks). */}
