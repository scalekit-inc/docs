---
displayed_sidebar: integrationsSidebar
---

# Microsoft AD FS

This guide walks you through configuring Single Sign-On (SSO) with Microsoft Active Directory Federation Services (AD FS) as your Identity Provider.

## What you'll learn

- How to set up a relying party trust in AD FS
- How to configure claims issuance policies
- How to establish the connection between AD FS and your application
- How to configure optional role assignments

## Before you begin

To successfully set up AD FS SAML integration, you'll need:

- Administrative access to your AD FS Management Console
- Access to the Admin Portal of the application you're integrating Microsoft AD FS with.

## Configuration steps

1. **Access ADFS Management**
   - Open ADFS Management from the Server Manager by clicking on 'Tools'

2. **Create a new Relying Party Trust**
   - In the left navigation pane, under 'Trust Relationships'
   - Right-click on 'Relying Party Trusts'
   - Choose 'Add Relying Party Trust' and click 'Start'

3. **Select data source**
   - Choose 'Enter data about the relying party manually'
   - Click 'Next'

4. **Specify display name**
   - Enter a descriptive name for your application (e.g., "Your App via Scalekit")
   - Click 'Next'


5. **Skip optional configurations**
   - Click 'Next' to skip the 'Choose Profile' and 'Configure Certificate' screens

6. **Configure SAML 2.0 support**
   - Check 'Enable support for the SAML 2.0 SSO WebSSO protocol'

7. **Gather service provider details**
   - In your Scalekit admin portal, select AD FS as your Identity Provider
   - Note the ACS URL and Entity ID provided in the Service Provider details

8. **Enter ACS URL**
   - Under 'Relying party SAML 2.0 SSO service URL', paste the ACS URL from Scalekit
   - Click 'Next'

9. **Configure identifiers**
   - Add the SP Entity ID from Scalekit as a 'Relying party trust identifier'
   - Click 'Next'

10. **Skip additional configurations**
    - Click 'Next' through the next three configuration screens

11. **Complete the wizard**
    - Check 'Open the Edit Claim Rules dialog for this relying party trust when the wizard closes'
    - Click 'Close'


12. **Create LDAP attributes claim rule**
    - In the 'Add Transform Claim Rule Wizard' window, select 'Send LDAP Attributes as Claims'
    - Click 'Next'


13. **Configure attribute mapping**
    - Enter a descriptive name for the rule (e.g., "User Attributes")
    - Map the following attributes:
      - `nameid` → ID
      - `email` → Email Address
      - `firstName` → First Name
      - `lastName` → Last Name
    - Click 'Finish'


14. **Add Transform an Incoming Claim rule**
    - Click 'Add rule' in the Edit Claim Rules window
    - Choose 'Transform an Incoming Claim' from the dropdown
    - Click 'Next'


15. **Configure attribute transformations**
    - Enter a descriptive name for the rule (e.g., "Email to NameID")
    - Configure the following values:
      - Incoming claim type: E-mail Address
      - Outgoing claim type: Name ID
      - Outgoing name ID format: Unspecified
    - Create additional transform rules for First Name and Last Name following the same pattern
    - Click 'Finish'

16. **Obtain the AD FS Metadata URL**
    - The standard format is: `https://YOUR_SERVER/federationmetadata/2007-06/federationmetadata.xml`
    - Alternatively, find it in AD FS Management under 'AD FS → Service → Endpoints' in the Metadata section

17. **Complete the Scalekit configuration**
    - In the Scalekit Admin Portal, navigate to Identity Provider Configuration
    - Select "Configure using Metadata URL (recommended)"
    - Enter the AD FS Metadata URL
    - Click "Update" to save the changes


## Verification

After completing the configuration, test the SSO integration by:

1. Logging out of your application
2. Attempting to log in using the SSO option
3. Verifying you're redirected to AD FS and can authenticate successfully

## Troubleshooting

If you encounter issues with your AD FS integration:

- Verify all claim mappings are correctly configured
- Check that the Metadata URL is accessible from Scalekit
- Ensure your AD FS server's clock is synchronized
- Review AD FS event logs for any authentication errors
