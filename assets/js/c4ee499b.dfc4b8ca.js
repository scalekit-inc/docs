"use strict";(self.webpackChunkscalekit_docs=self.webpackChunkscalekit_docs||[]).push([[3168],{31468:(s,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>t,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"m2m/api-auth-for-m2m-clients","title":"API Authentication for M2M Clients","description":"This guide explains how your application can validate API requests from machine-to-machine (M2M) clients using Scalekit\'s M2M authentication system.","source":"@site/docs/m2m/api-auth-for-m2m-clients.mdx","sourceDirName":"m2m","slug":"/m2m/api-auth-for-m2m-clients","permalink":"/m2m/api-auth-for-m2m-clients","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"displayed_sidebar":"m2mSidebar","pagination_next":null,"pagination_prev":null},"sidebar":"m2mSidebar"}');var n=i(74848),r=i(28453);const a={displayed_sidebar:"m2mSidebar",pagination_next:null,pagination_prev:null},c="API Authentication for M2M Clients",o={},d=[{value:"How M2M Clients Authenticate with Your API",id:"how-m2m-clients-authenticate-with-your-api",level:2},{value:"Storing Client Credentials",id:"storing-client-credentials",level:3},{value:"Obtaining Access Tokens",id:"obtaining-access-tokens",level:3},{value:"Using Access Tokens",id:"using-access-tokens",level:3},{value:"Validating Access Tokens",id:"validating-access-tokens",level:2},{value:"Retrieving JWKS",id:"retrieving-jwks",level:3},{value:"Token Validation Process",id:"token-validation-process",level:3},{value:"Example: Token Validation with cURL and jq",id:"example-token-validation-with-curl-and-jq",level:3},{value:"Example: Token Validation with Node.js",id:"example-token-validation-with-nodejs",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"SDK Support Status",id:"sdk-support-status",level:2}];function h(s){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...s.components},{CodeWithHeader:i}=e;return i||function(s,e){throw new Error("Expected "+(e?"component":"object")+" `"+s+"` to be defined: you likely forgot to import, pass, or provide it.")}("CodeWithHeader",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.header,{children:(0,n.jsx)(e.h1,{id:"api-authentication-for-m2m-clients",children:"API Authentication for M2M Clients"})}),"\n",(0,n.jsx)(e.p,{children:"This guide explains how your application can validate API requests from machine-to-machine (M2M) clients using Scalekit's M2M authentication system.\nThis guide explains the authentication flow, from obtaining access tokens to validating requests using JSON Web Key Sets (JWKS)."}),"\n",(0,n.jsx)(e.h2,{id:"how-m2m-clients-authenticate-with-your-api",children:"How M2M Clients Authenticate with Your API"}),"\n",(0,n.jsx)(e.p,{children:"Every Scalekit environment functions as an Authorization Server. M2M clients authenticate using client credentials with this server."}),"\n",(0,n.jsx)(e.h3,{id:"storing-client-credentials",children:"Storing Client Credentials"}),"\n",(0,n.jsx)(e.p,{children:"M2M clients must securely store their credentials in environment variables:"}),"\n",(0,n.jsx)(i,{title:"Environment variables",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"YOURAPP_ENVIRONMENT_URL"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:"=<"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"YOURAPP_SCALEKIT_ENVIRONMENT_URL"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:">"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"YOURAPP_CLIENT_ID"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:"=<"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"YOURAPP_CLIENT_ID"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:">"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"YOURAPP_CLIENT_SECRET"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:"=<"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"YOURAPP_CLIENT_SECRET"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:">"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.h3,{id:"obtaining-access-tokens",children:"Obtaining Access Tokens"}),"\n",(0,n.jsx)(e.p,{children:"To authenticate API requests, clients must first obtain an access token from your authorization server using the Token endpoint:"}),"\n",(0,n.jsx)(i,{title:"Token endpoint",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"https://"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"<YOURAPP_SCALEKIT_ENVIRONMENT_URL>/oauth/token"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.p,{children:"The client sends their credentials to this endpoint:"}),"\n",(0,n.jsx)(i,{title:"Token request",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"curl"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" -X"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" POST"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'  "https://<YOURAPP_SCALEKIT_ENVIRONMENT_URL>/oauth/token"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -H"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "Content-Type: application/x-www-form-urlencoded"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -d"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "grant_type=client_credentials"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -d"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "client_id=<YOURAPP_CLIENT_ID>"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -d"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "client_secret=<YOURAPP_CLIENT_SECRET>"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -d"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "scope=openid profile email"'})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.p,{children:"The server returns a JSON response containing the access token:"}),"\n",(0,n.jsx)(i,{title:"Token response",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-json",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"{"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "access_token"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"<YOURAPP_ACCESS_TOKEN>"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "token_type"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"Bearer"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "expires_in"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"86399"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "scope"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"openid"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.th,{children:"Field"}),(0,n.jsx)(e.th,{children:"Description"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:"access_token"}),(0,n.jsx)(e.td,{children:"Token for authenticating API requests"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:"token_type"}),(0,n.jsx)(e.td,{children:'Always "Bearer" for this flow'})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:"expires_in"}),(0,n.jsx)(e.td,{children:"Token validity period in seconds (typically 24 hours)"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{children:"scope"}),(0,n.jsx)(e.td,{children:"Authorized scopes for this token"})]})]})]}),"\n",(0,n.jsx)(e.h3,{id:"using-access-tokens",children:"Using Access Tokens"}),"\n",(0,n.jsx)(e.p,{children:"After obtaining the access token, clients include it in the Authorization header of their API requests:"}),"\n",(0,n.jsx)(i,{title:"API request with access token",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"curl"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" --request"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" GET"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "https://<your-api-endpoint>"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -H"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "Content-Type: application/json"'}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"  -H"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "Authorization: Bearer <YOURAPP_ACCESS_TOKEN>"'})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.h2,{id:"validating-access-tokens",children:"Validating Access Tokens"}),"\n",(0,n.jsx)(e.p,{children:"Your API server must validate access tokens before processing requests. Scalekit uses JSON Web Tokens (JWTs) signed with RSA keys, which you validate using the JSON Web Key Set (JWKS) endpoint."}),"\n",(0,n.jsx)(e.h3,{id:"retrieving-jwks",children:"Retrieving JWKS"}),"\n",(0,n.jsx)(e.p,{children:"Your application should fetch the public keys from the JWKS endpoint:"}),"\n",(0,n.jsx)(i,{title:"JWKS endpoint",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"https://"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"<YOURAPP_ENVIRONMENT_URL>/.well-known/jwks.json"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(i,{title:"JWKS response",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-json",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"{"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "keys"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": ["})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"    {"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "use"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"sig"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "kty"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"RSA"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "kid"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"snk_58327480989122566"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "alg"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"RS256"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "n"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"wUaqIj3pIE_zfGN9u4GySZs862F-0Kl-.."'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'      "e"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"AQAB"'})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"    }"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  ]"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.h3,{id:"token-validation-process",children:"Token Validation Process"}),"\n",(0,n.jsx)(e.p,{children:"When your API receives a request with a JWT, follow these steps:"}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Extract the token from the Authorization header"}),"\n",(0,n.jsx)(e.li,{children:"Fetch the JWKS from the endpoint"}),"\n",(0,n.jsx)(e.li,{children:"Use the public key from JWKS to verify the token's signature"}),"\n",(0,n.jsx)(e.li,{children:"Validate the token's claims (issuer, audience, expiration)"}),"\n"]}),"\n",(0,n.jsx)(e.h3,{id:"example-token-validation-with-curl-and-jq",children:"Example: Token Validation with cURL and jq"}),"\n",(0,n.jsx)(e.p,{children:"This example shows how to fetch JWKS data:"}),"\n",(0,n.jsx)(i,{title:"Fetch JWKS with cURL",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-sh",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"curl"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" -s"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:' "https://<YOURAPP_ENVIRONMENT_URL>/keys"'}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#F97583"},children:" |"}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" jq"})]}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.h3,{id:"example-token-validation-with-nodejs",children:"Example: Token Validation with Node.js"}),"\n",(0,n.jsx)(i,{title:"Node.js JWT Verification",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-javascript",children:[(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" express"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" require"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'express'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:");"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" jwt"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" require"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'jsonwebtoken'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:");"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" jwksClient"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" require"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'jwks-rsa'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:");"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" app"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" express"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"();"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Initialize JWKS client"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" client"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" jwksClient"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"  jwksUri"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" `https://<YOURAPP_ENVIRONMENT_URL>/keys`"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"});"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Function to get signing key"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"function"}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" getKey"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"header"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"callback"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  client."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"getSigningKey"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"(header."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"kid"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"function"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"err"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"key"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"    if"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" (err) "}),(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"return"}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" callback"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"(err);"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"    const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" signingKey"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" key."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"publicKey"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ||"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" key."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"rsaPublicKey"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"    callback"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"null"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", signingKey);"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  });"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Middleware to validate JWT"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"function"}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:" validateJwt"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"req"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"res"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"next"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") {"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"  // Extract token from header"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" authHeader"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" req."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"headers"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"authorization"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:";"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  if"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" ("}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:"!"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"authHeader "}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:"||"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" !"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"authHeader."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"startsWith"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'Bearer '"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:")) {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"    return"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" res."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"status"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"401"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:")."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({ "}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"error"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'Missing authorization token'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" });"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  }"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"  const"}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" token"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" authHeader."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"split"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"' '"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:")["}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"1"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"];"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"  // Verify token"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  jwt."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"verify"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"(token, getKey, {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"    algorithms"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" ["}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'RS256'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"]"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  }, ("}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"err"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"decoded"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") "}),(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"    if"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" (err) {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"      return"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" res."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"status"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"401"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:")."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({ "}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"error"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'Invalid token'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"details"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" err."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"message"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" });"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"    }"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"    // Add decoded token to request object"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"    req."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"user"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#F97583"},children:" ="}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" decoded;"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"    next"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"();"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  });"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Apply middleware to protected routes"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"app."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"use"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'/api'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", validateJwt);"})]}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Example protected route"})}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"app."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"get"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'/api/data'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", ("}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"req"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#FFAB70"},children:"res"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:") "}),(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  res."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"json"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"({ "}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"message"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'Authenticated successfully'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"userId"}),(0,n.jsx)(e.span,{style:{color:"#0184BC","--shiki-dark":"#E1E4E8"},children:":"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" req."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"user"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"."}),(0,n.jsx)(e.span,{style:{color:"#E45649","--shiki-dark":"#E1E4E8"},children:"sub"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" });"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"});"})}),"\n",(0,n.jsx)(e.span,{className:"line"}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"app."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"listen"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"3000"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", () "}),(0,n.jsx)(e.span,{style:{color:"#A626A4","--shiki-dark":"#F97583"},children:"=>"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:" {"})]}),"\n",(0,n.jsxs)(e.span,{className:"line",children:[(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  console."}),(0,n.jsx)(e.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"log"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"("}),(0,n.jsx)(e.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'Server running on port 3000'"}),(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:");"})]}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"});"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(i,{title:"Express API server setup",children:(0,n.jsx)(e.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,n.jsxs)(e.code,{className:"language-javascript",children:[(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Install required packages:"})}),"\n",(0,n.jsx)(e.span,{className:"line",children:(0,n.jsx)(e.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// npm install express jsonwebtoken jwks-rsa"})}),"\n",(0,n.jsx)(e.span,{className:"line"})]})})}),"\n",(0,n.jsx)(e.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,n.jsx)(e.p,{children:"When implementing token validation:"}),"\n",(0,n.jsxs)(e.ol,{children:["\n",(0,n.jsx)(e.li,{children:"Always verify the token signature using the public key from JWKS"}),"\n",(0,n.jsx)(e.li,{children:"Validate token expiration and required claims"}),"\n",(0,n.jsx)(e.li,{children:"Consider caching JWKS responses to improve performance"}),"\n",(0,n.jsx)(e.li,{children:"Implement token revocation checks for sensitive operations"}),"\n",(0,n.jsx)(e.li,{children:"Use HTTPS for all API endpoints"}),"\n"]}),"\n",(0,n.jsx)(e.h2,{id:"sdk-support-status",children:"SDK Support Status"}),"\n",(0,n.jsx)(e.p,{children:"Our Python SDK currently includes support for M2M authentication. The support to verify tokens is coming soon to Node, Java, and Go SDKs."})]})}function t(s={}){const{wrapper:e}={...(0,r.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(h,{...s})}):h(s)}},28453:(s,e,i)=>{i.d(e,{R:()=>a,x:()=>c});var l=i(96540);const n={},r=l.createContext(n);function a(s){const e=l.useContext(r);return l.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function c(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(n):s.components||n:a(s.components),l.createElement(r.Provider,{value:e},s.children)}}}]);