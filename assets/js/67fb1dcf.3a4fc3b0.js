"use strict";(self.webpackChunkscalekit_docs=self.webpackChunkscalekit_docs||[]).push([[3290],{42062:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"m2m/scopes","title":"M2M Client Scopes","description":"Scopes define the permissions an application possesses. Within Scalekit, scopes allow your API server (acting as an M2M server) to determine the permissions granted to an M2M client application.","source":"@site/docs/m2m/scopes.mdx","sourceDirName":"m2m","slug":"/m2m/scopes","permalink":"/m2m/scopes","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"m2mSidebar","previous":{"title":"External IDs and Metadata","permalink":"/m2m/external-ids-and-metadata"}}');var l=i(74848),r=i(28453);const a={},t="M2M Client Scopes",c={},o=[{value:"Validating M2M Client Scopes",id:"validating-m2m-client-scopes",level:2}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",span:"span",...(0,r.R)(),...e.components},{CodeWithHeader:i}=s;return i||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("CodeWithHeader",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"m2m-client-scopes",children:"M2M Client Scopes"})}),"\n",(0,l.jsx)(s.p,{children:"Scopes define the permissions an application possesses. Within Scalekit, scopes allow your API server (acting as an M2M server) to determine the permissions granted to an M2M client application."}),"\n",(0,l.jsx)(s.p,{children:"When creating an M2M client via the API, your application specifies the required scopes. Scalekit includes this scope information in the access token that the M2M client uses for subsequent API requests."}),"\n",(0,l.jsx)(i,{title:"Register an M2M client with specific scopes",children:(0,l.jsx)(s.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,l.jsxs)(s.code,{className:"language-sh",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"curl"}),(0,l.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:" -L"}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" 'https://<SCALEKIT_ENVIRONMENT_URL>/api/v1/organizations/<ORGANIZATION_ID>/clients'"}),(0,l.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"-H "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'Content-Type: application/json'"}),(0,l.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"-H "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"'Authorization: Bearer <SCALEKIT_ACCESS_TOKEN>'"}),(0,l.jsx)(s.span,{style:{color:"#0184BC","--shiki-dark":"#79B8FF"},children:" \\"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"# Remember to replace placeholders like <SCALEKIT_ACCESS_TOKEN> with actual values."})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#4078F2","--shiki-dark":"#B392F0"},children:"-d"}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:" '{"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "name": "GitHub Actions Deployment Service",'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "description": "Service account for GitHub Actions to deploy applications to production",'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "scopes": ['})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'        "deploy:applications",'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'        "read:deployments"'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"    ],"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "expiry": 3600 # Token expiry time in seconds'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:"}'"})}),"\n",(0,l.jsx)(s.span,{className:"line"})]})})}),"\n",(0,l.jsxs)(s.p,{children:["The API returns a JSON object ",(0,l.jsx)(s.a,{href:"/m2m/quickstart#register-m2m-client",children:"containing comprehensive information"})," about the newly created M2M client. Your application (acting as the M2M server) should securely provide only the ",(0,l.jsx)(s.code,{children:"client_id"})," and ",(0,l.jsx)(s.code,{children:"client_secret"})," from the response to the M2M client application that needs to authenticate."]}),"\n",(0,l.jsxs)(s.p,{children:["The M2M client then uses its client ID and client secret to ",(0,l.jsx)(s.a,{href:"/m2m/api-auth-for-m2m-clients",children:"authenticate with your API server"}),". Successful authentication grants the M2M client an access token, which it includes as a Bearer token in the ",(0,l.jsx)(s.code,{children:"Authorization"})," header for future API requests."]}),"\n",(0,l.jsx)(s.h2,{id:"validating-m2m-client-scopes",children:"Validating M2M Client Scopes"}),"\n",(0,l.jsxs)(s.p,{children:["When your API server receives a request from an M2M client, it must validate the scopes present in the access token provided in the ",(0,l.jsx)(s.code,{children:"Authorization"})," header. The access token is a JSON Web Token (JWT)."]}),"\n",(0,l.jsx)(i,{title:"Example Decoded Access Token JWT Payload",children:(0,l.jsx)(s.pre,{className:"shiki shiki-themes one-light github-dark",style:{backgroundColor:"#FAFAFA","--shiki-dark-bg":"#24292e",color:"#383A42","--shiki-dark":"#e1e4e8"},tabIndex:"0",children:(0,l.jsxs)(s.code,{className:"language-json",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"{"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "client_id"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"m2morg_69038819013296423"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// The unique ID of the M2M client"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "exp"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"1745305340"}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Expiration timestamp"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "iat"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"1745218940"}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Issued at timestamp"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "iss"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"<SCALEKIT_ENVIRONMENT_URL>"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Issuer (Scalekit environment URL)"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "jti"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"tkn_69041163914445100"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// JWT unique identifier"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "nbf"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#986801","--shiki-dark":"#79B8FF"},children:"1745218940"}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Not before timestamp"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "oid"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"org_59615193906282635"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:", "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Organization ID the client belongs to"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "scopes"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": [ "}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:"// Array of permissions granted to this client"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "deploy:applications"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:","})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'    "read:deployments"'})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"  ],"})}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"#E45649","--shiki-dark":"#79B8FF"},children:'  "sub"'}),(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:": "}),(0,l.jsx)(s.span,{style:{color:"#50A14F","--shiki-dark":"#9ECBFF"},children:'"m2morg_69038819013296423"'}),(0,l.jsx)(s.span,{style:{color:"#A0A1A7","--shiki-dark":"#6A737D",fontStyle:"italic","--shiki-dark-font-style":"inherit"},children:" // Subject (usually the client_id for M2M)"})]}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"#383A42","--shiki-dark":"#E1E4E8"},children:"}"})}),"\n",(0,l.jsx)(s.span,{className:"line"})]})})}),"\n",(0,l.jsxs)(s.p,{children:["Scalekit encodes the granted permissions in the ",(0,l.jsx)(s.code,{children:"scopes"})," field within the JWT payload. The ",(0,l.jsx)(s.code,{children:"oid"})," field identifies the specific organization (customer/tenant) associated with this M2M client."]}),"\n",(0,l.jsxs)(s.p,{children:["Your API server should inspect the ",(0,l.jsx)(s.code,{children:"scopes"})," array in the received token payload. Use this information to authorize the requested operation, ensuring the client possesses the necessary permissions before processing the API request."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>a,x:()=>t});var n=i(96540);const l={},r=n.createContext(l);function a(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);